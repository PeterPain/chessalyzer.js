!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("chessalyzer",[],t):"object"==typeof exports?exports.chessalyzer=t():e.chessalyzer=t()}(global,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(1).performance,i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.profilingActive=!1,this.time=0,this.t0=0,void 0===this.track)throw new Error("Your analyzer must implement a track() method!");if(void 0===this.type)throw new Error("Your analyzer must specify a type!")}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"startTimer",value:function(){this.profilingActive&&(this.t0=o.now())}},{key:"endTimer",value:function(){this.profilingActive&&(this.time+=o.now()-this.t0)}}]),e}();t.default=i,e.exports=t.default},function(e,t){e.exports=require("perf_hooks")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(3)).default;t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(4)),o=a(n(8)),i=a(n(9)),s=a(n(10));function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=n(1).performance,l=n(11),f=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],h=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&u(e.prototype,t),n&&u(e,n)}(e,null,[{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{fun:function(){},rate:250},i=new r.default;return i.on("status",function(e){o.fun(e)}),new Promise(function(r){var s=c.now();i.processPGN(e,t,n,o.rate).then(function(){var e=c.now(),t=Math.round(e-s)/1e3,n=Math.round(i.cntMoves/t);console.log("".concat(i.cntGames," games (").concat(i.cntMoves," moves) processed in ").concat(t,"s (").concat(n," moves/s)")),r()})})}},{key:"saveData",value:function(e,t){l.writeFile(e,JSON.stringify(t),function(e){e?console.error(e):console.log("File has been created.")})}},{key:"loadData",value:function(e){var t=JSON.parse(l.readFileSync(e,"utf8"));return console.log("File '".concat(e,"' has been loaded.")),t}},{key:"generateHeatmap",value:function(e,t,n,o){for(var i=r.default.algebraicToCoords(t),s=[],a=0,u=1e6,c=0;c<8;c+=1){for(var l=new Array(8),f=0;f<8;f+=1)l[f]=n(e,i,[c,f],o),l[f]>a&&(a=l[f]),l[f]<u&&(u=l[f]);s.push(l)}return[s,u,a]}},{key:"generateComparisonHeatmap",value:function(t,n,r,o,i){for(var s=[],a=0,u=1e5,c=e.generateHeatmap(r,t,n,i),l=e.generateHeatmap(o,t,n,i),f=0;f<8;f+=1){for(var h=new Array(8),p=0;p<8;p+=1){var v=c[0][f][p],d=l[0][f][p];h[p]=0===v||0===d?0:100*(v>=d?v/d-1:-d/v+1),h[p]>a&&(a=h[p]),h[p]<u&&(u=h[p])}s.push(h)}return[s,u,a]}},{key:"generateList",value:function(e){for(var t=[],n=0;n<8;n+=1)for(var r=0;r<8;r+=1){var o=e[n][r];o=o.toFixed(2),Math.abs(o)>.001&&(0===n?t.push(["b".concat(h[r]),o]):1===n?t.push(["b".concat(f[r]),o]):6===n?t.push(["w".concat(f[r]),o]):7===n&&t.push(["w".concat(h[r]),o]))}return t.sort(function(e,t){return t[1]-e[1]}),t}}]),e}();p.GameTracker=s.default,p.PieceTracker=o.default,p.TileTracker=i.default;var v=p;t.default=v,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(5));function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=n(6),l=n(7),f="abcdefgh",h=function e(){u(this,e),this.san="",this.player="",this.piece="",this.castles="",this.takes={},this.promotesTo="",this.from=[-1,-1],this.to=[-1,-1]},p=function(e){function t(){var e;return u(this,t),(e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).board=new r.default,e.currentMove=new h,e.activePlayer=0,e.cntMoves=0,e.cntGames=0,e.gameAnalyzers=[],e.moveAnalyzers=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,l),function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(t,[{key:"processPGN",value:function(e,n,r,o){var i=this,s=t.checkConfig(n);r.forEach(function(e){"move"===e.type?i.moveAnalyzers.push(e):"game"===e.type&&i.gameAnalyzers.push(e)});var a=this.gameAnalyzers.length;return new Promise(function(t,n){var r=new c(e,{skipEmptyLines:!0}),u={};r.on("error",function(e){console.log(e),n()}),r.on("line",function(e){r.pause(),function(e){if(e.startsWith("[")&&(s.hasFilter||a>0)){var t=e.match(/\[(.*?)\s/)[1],n=e.match(/"(.*?)"/)[1];u[t]=n}else e.startsWith("1")&&(u.moves=e.replace(/\{(.*?)\}\s/g,"").replace(/\d+\.+\s/g,"").replace(" *","").split(" "),!s.filter(u)&&s.hasFilter||i.processGame(u),i.cntGames%o==0&&i.emit("status",i.cntGames),u={});i.cntGames>=s.cntGames?(r.close(),r.end()):r.resume()}(e)}),r.on("end",function(){console.log("Read entire file."),t()})})}},{key:"processGame",value:function(e){for(var t=this,n=e.moves,r=0;r<n.length;r+=1)this.activePlayer=r%2,this.parseMove(n[r]),this.moveAnalyzers.forEach(function(e){e.track(t.currentMove)}),this.board.move(this.currentMove);this.cntMoves+=n.length-1,this.cntGames+=1,this.board.reset(),this.gameAnalyzers.forEach(function(t){t.track(e)})}},{key:"reset",value:function(){this.board.reset(),this.activePlayer=0}},{key:"parseMove",value:function(e){var n=e.substring(0,1),r=t.preProcess(e);this.currentMove=new h,this.currentMove.san=e,this.currentMove.player=0===this.activePlayer?"w":"b",null===n.match(/\d/)&&(n.toLowerCase()===n?this.pawnMove(r):"O"!==n?this.pieceMove(r):this.currentMove.castles=r)}},{key:"pawnMove",value:function(e){var t=this.activePlayer%2*-2+1,n=[],r=[],o=e,i=0;if(o.includes("x"))o=o.replace("x",""),r[0]=8-parseInt(o.substring(2,3),10),r[1]=f.indexOf(o.substring(1,2)),n[0]=r[0]+t,n[1]=f.indexOf(o.substring(0,1)),null===this.board.tiles[r[0]][r[1]]&&(i="w"===this.currentMove.player?1:-1),this.currentMove.takes.piece=this.board.tiles[r[0]+i][r[1]].name,this.currentMove.takes.pos=[r[0]+i,r[1]];else{var s=8-parseInt(o.substring(1,2),10),a=f.indexOf(o.substring(0,1));n[1]=a,r[0]=s,r[1]=a;for(var u=s+t;u<8&&u>=0;u+=t)if(null!==this.board.tiles[u][a]&&this.board.tiles[u][a].name.includes("P")){n[0]=u;break}}this.currentMove.to=r,this.currentMove.from=n,this.currentMove.piece=this.board.tiles[n[0]][n[1]].name,o.includes("=")&&(this.currentMove.promotesTo=o.substring(o.length-1,o.length))}},{key:"pieceMove",value:function(e){var t=e,n=!1,r={from:[],to:[]},o=t.substring(0,1);if((t=t.substring(1,t.length)).includes("x")&&(n=!0,t=t.replace("x","")),4===t.length)r.from[0]=8-parseInt(t.substring(1,2),10),r.from[1]=f.indexOf(t.substring(0,1)),r.to[0]=8-parseInt(t.substring(3,4),10),r.to[1]=f.indexOf(t.substring(2,3));else if(3===t.length){var i=8-parseInt(t.substring(2,3),10),s=f.indexOf(t.substring(1,2)),a=-1,u=-1;f.indexOf(t.substring(0,1))>=0?u=f.indexOf(t.substring(0,1)):a=8-parseInt(t.substring(0,1),10),r=this.findPiece(i,s,a,u,o)}else{var c=8-parseInt(t.substring(1,2),10),l=f.indexOf(t.substring(0,1));r=this.findPiece(c,l,-1,-1,o)}this.currentMove.from=r.from,this.currentMove.to=r.to,this.currentMove.piece=this.board.tiles[r.from[0]][r.from[1]].name,n&&(this.currentMove.takes.piece=this.board.tiles[this.currentMove.to[0]][this.currentMove.to[1]].name,this.currentMove.takes.pos=this.currentMove.to)}},{key:"findPiece",value:function(e,t,n,r,o){var i;return"R"===o?i=this.findLine(e,t,n,r,o):"B"===o?i=this.findDiag(e,t,n,r,o):"Q"===o||"K"===o?-1===(i=this.findDiag(e,t,n,r,o)).from[0]&&(i=this.findLine(e,t,n,r,o)):"N"===o&&(i=this.findKnight(e,t,n,r,o)),-1===i.from[0]&&(console.log("Error: no piece for move ".concat(o," to (").concat(e,",").concat(t,") found!")),console.log(this.cntGames),console.log(this.currentMove),this.board.printPosition()),i}},{key:"findDiag",value:function(e,t,n,r,o){var i=this.currentMove.player,s=[],a=[];s[0]=-1,s[1]=-1,a[0]=e,a[1]=t;for(var u=-1;u<=1;u+=2)for(var c=!1,l=!1,f=1;f<8;f+=1){var h=a[0]+u*f,p=a[1]+f,v=a[0]-u*f,d=a[1]-f;if(!c&&h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var b=this.board.tiles[h][p];if(!b.name.includes(o)||b.color!==i||-1!==n&&h!==n||-1!==r&&p!==r)c=!0;else if(!this.checkCheck([h,p],[a[0],a[1]]))return s[0]=h,s[1]=p,{from:s,to:a}}if(!l&&v>=0&&v<8&&d>=0&&d<8&&null!==this.board.tiles[v][d]){var y=this.board.tiles[v][d];if(!y.name.includes(o)||y.color!==i||-1!==n&&v!==n||-1!==r&&d!==r)l=!0;else if(!this.checkCheck([v,d],[a[0],a[1]]))return s[0]=v,s[1]=d,{from:s,to:a}}}return{from:s,to:a}}},{key:"findLine",value:function(e,t,n,r,o){var i=this.currentMove.player,s=[],a=[];s[0]=-1,s[1]=-1,a[0]=e,a[1]=t;for(var u=-1;u<=1;u+=2)for(var c=!1,l=!1,f=1;f<8;f+=1){var h=a[0],p=a[1]-u*f,v=a[0]-u*f,d=a[1];if(!c&&h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var b=this.board.tiles[h][p];if(!b.name.includes(o)||b.color!==i||-1!==n&&h!==n||-1!==r&&p!==r)c=!0;else if(!this.checkCheck([h,p],[a[0],a[1]]))return s[0]=h,s[1]=p,{from:s,to:a}}if(!l&&v>=0&&v<8&&d>=0&&d<8&&null!==this.board.tiles[v][d]){var y=this.board.tiles[v][d];if(!y.name.includes(o)||y.color!==i||-1!==n&&v!==n||-1!==r&&d!==r)l=!0;else if(!this.checkCheck([v,d],[a[0],a[1]]))return s[0]=v,s[1]=d,{from:s,to:a}}}return{from:s,to:a}}},{key:"findKnight",value:function(e,t,n,r,o){var i=this.currentMove.player,s=[],a=[];s[0]=-1,s[1]=-1,a[0]=e,a[1]=t;for(var u=-2;u<=2;u+=4)for(var c=-1;c<=1;c+=2){var l=a[0]+u,f=a[1]+c,h=a[0]+c,p=a[1]+u;if(l>=0&&l<8&&f>=0&&f<8&&null!==this.board.tiles[l][f]){var v=this.board.tiles[l][f];if(v.name.includes(o)&&v.color===i&&(-1===n||l===n)&&(-1===r||f===r)&&!this.checkCheck([l,f],[a[0],a[1]]))return s[0]=l,s[1]=f,{from:s,to:a}}if(h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var d=this.board.tiles[h][p];if(d.name.includes(o)&&d.color===i&&(-1===n||h===n)&&(-1===r||p===r)&&!this.checkCheck([h,p],[a[0],a[1]]))return s[0]=h,s[1]=p,{from:s,to:a}}}return{from:s,to:a}}},{key:"checkCheck",value:function(e,t){var n=this.currentMove.player,r="w"===this.currentMove.player?"b":"w",o=this.board.kingPos[n],i=!1;if(o[0]===e[0]&&o[1]===e[1])return!1;var s=[];s[0]=e[0]-o[0],s[1]=e[1]-o[1];var a=[];if(0===s[0]||0===s[1])a[0]="Q",a[1]="R";else{if(Math.abs(s[0])!==Math.abs(s[1]))return!1;a[0]="Q",a[1]="B"}0!==s[0]&&(s[0]/=Math.abs(s[0])),0!==s[1]&&(s[1]/=Math.abs(s[1]));var u=this.board.tiles[e[0]][e[1]],c=this.board.tiles[t[0]][t[1]];this.board.tiles[e[0]][e[1]]=null,this.board.tiles[t[0]][t[1]]=u;for(var l=!1,f=1;f<8&&!i&&!l;f+=1){var h=o[0]+f*s[0],p=o[1]+f*s[1];if(h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var v=this.board.tiles[h][p];(v.name.includes(a[0])||v.name.includes(a[1]))&&v.color===r?i=!0:l=!0}}return this.board.tiles[e[0]][e[1]]=u,this.board.tiles[t[0]][t[1]]=c,i}}],[{key:"checkConfig",value:function(e){var t={};return t.hasFilter=Object.prototype.hasOwnProperty.call(e,"filter"),t.filter=t.hasFilter?e.filter:function(){return!0},t.cntGames=Object.prototype.hasOwnProperty.call(e,"cntGames")?e.cntGames:1/0,t.split=!!Object.prototype.hasOwnProperty.call(e,"split")&&e.split,t}},{key:"algebraicToCoords",value:function(e){var t=[],n=e.split("");return t.push(8-n[1]),t.push(f.indexOf(n[0])),t}},{key:"coordsToAlgebraic",value:function(e){var t=f[e[1]];return t+=8-e[0]}},{key:"preProcess",value:function(e){return e.replace(/#|\+|\?|!/g,"")}}]),t}();t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],s=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],a=function e(t,n){o(this,e),this.name=t,this.color=n},u=function(){function e(){o(this,e),this.tiles=new Array(8);for(var t=0;t<8;t+=1){for(var n=new Array(8),r=0;r<8;r+=1){n[r]=null;var u=0===t||1===t?"b":"w";0===t||7===t?n[r]=new a(s[r],u):1!==t&&6!==t||(n[r]=new a(i[r],u))}this.tiles[t]=n}this.defaultTiles=this.tiles.map(function(e){return e.slice()}),this.kingPos={w:[7,4],b:[0,4]}}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"move",value:function(e){var t=e.from,n=e.to;""!==e.castles?this.castle(e.castles,e.player):-1!==t[0]&&("pos"in e.takes&&(this.tiles[e.takes.pos[0]][e.takes.pos[1]]=null),this.tiles[n[0]][n[1]]=this.tiles[t[0]][t[1]],this.tiles[t[0]][t[1]]=null,""!==e.promotesTo&&(this.tiles[n[0]][n[1]]=new a(e.promotesTo,e.player)),"K"===e.san.substring(0,1)&&(this.kingPos[e.player]=n))}},{key:"castle",value:function(e,t){var n="w"===t?7:0,r=6,o=7,i=5;"O-O-O"===e&&(r=2,i=3,o=0),this.tiles[n][r]=this.tiles[n][4],this.tiles[n][i]=this.tiles[n][o],this.tiles[n][4]=null,this.tiles[n][o]=null,this.kingPos[t]=[n,r]}},{key:"reset",value:function(){this.tiles=this.defaultTiles.map(function(e){return e.slice()}),this.kingPos={w:[7,4],b:[0,4]}}},{key:"printPosition",value:function(){for(var e=0;e<8;e+=1){for(var t=[],n=0;n<8;n+=1){var r=this.tiles[e][n];null!==r?t.push(r.color+r.name):t.push("...")}console.log(t)}}}]),e}();t.default=u,e.exports=t.default},function(e,t){e.exports=require("line-by-line")},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],c=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],l=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"move"))).b={},e.w={},u.forEach(function(t){e.w[t]={},e.b[t]={}}),c.forEach(function(t){e.w[t]={},e.b[t]={}}),Object.keys(e.w).forEach(function(t){u.forEach(function(n){e.w[t][n]=0,e.b[t][n]=0}),c.forEach(function(n){e.w[t][n]=0,e.b[t][n]=0})}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,r.default),function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(t,[{key:"track",value:function(e){this.startTimer();var t=e.player,n=e.piece,r=e.takes;void 0!==r.piece&&n.length>1&&r.piece.length>1&&this.processTakes(t,n,r.piece),this.endTimer()}},{key:"processTakes",value:function(e,t,n){this[e][t][n]+=1}}]),t}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],l=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],f=function e(){u(this,e),this.movedTo=0,this.wasOn=0,this.killedOn=0,this.wasKilledOn=0},h=function(e){function t(){var e;u(this,t),(e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"move"))).tiles=new Array(8);for(var n=function(t){for(var n=new Array(8),r=function(e){n[e]={b:{},w:{}},n[e].b=new f,n[e].w=new f,c.forEach(function(t){n[e].b[t]=new f,n[e].w[t]=new f}),l.forEach(function(t){n[e].b[t]=new f,n[e].w[t]=new f})},o=0;o<8;o+=1)r(o);e.tiles[t]=n},r=0;r<8;r+=1)n(r);return e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,r.default),function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(t,[{key:"track",value:function(e){this.startTimer();var t=e.to,n=e.player,r=e.piece,o=e.takes,i=e.castles;if(-1!==t[0])this.processMove(t,n,r),void 0!==o.piece&&this.processTakes(o.pos,n,r,o.piece);else if(""!==i){var s="w"===n?7:0,a="Rh",u=6,c=5;"O-O-O"===i&&(u=2,c=3,a="Ra"),this.processMove([s,u],n,"Ke"),this.processMove([s,c],n,a)}this.endTimer()}},{key:"processMove",value:function(e,t,n){n.length>1&&(this.tiles[e[0]][e[1]][t].movedTo+=1,this.tiles[e[0]][e[1]][t][n].movedTo+=1)}},{key:"processTakes",value:function(e,t,n,r){if(n.length>1&&r.length>1){var o="w"===t?"b":"w";this.tiles[e[0]][e[1]][t].killedOn+=1,this.tiles[e[0]][e[1]][t][n].killedOn+=1,this.tiles[e[0]][e[1]][o].wasKilledOn+=1,this.tiles[e[0]][e[1]][o][r].wasKilledOn+=1}}}]),t}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"game"))).wins=[0,0,0],e.cntGames=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,r.default),function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(t,[{key:"track",value:function(e){switch(this.startTimer(),this.cntGames+=1,e.Result){case"1-0":this.wins[0]+=1;break;case"1/2-1/2":this.wins[1]+=1;break;case"0-1":this.wins[2]+=1}this.endTimer()}}]),t}();t.default=u,e.exports=t.default},function(e,t){e.exports=require("fs")}])});
//# sourceMappingURL=chessalyzer.min.js.map