!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("chessalyzer",[],t):"object"==typeof exports?exports.chessalyzer=t():e.chessalyzer=t()}(global,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(1).performance,o=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.profilingActive=!1,this.time=0,this.t0=0,void 0===this.track)throw new Error("Your analyzer must implement a track() method!");if(void 0===this.type)throw new Error("Your analyzer must specify a type!")}var t,n,o;return t=e,(n=[{key:"startTimer",value:function(){this.profilingActive&&(this.t0=i.now())}},{key:"endTimer",value:function(){this.profilingActive&&(this.time+=i.now()-this.t0)}}])&&r(t.prototype,n),o&&r(t,o),e}();t.default=o,e.exports=t.default},function(e,t){e.exports=require("perf_hooks")},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=((r=n(3))&&r.__esModule?r:{default:r}).default;t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(4)),i=u(n(8)),o=u(n(9)),s=u(n(10)),a=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=n(1).performance,f=n(11),h=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],p=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"startBatch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{fun:function(){},rate:250},o=t;Array.isArray(o)||(o=[t]);var s=new r.default;return s.on("status",function(e){i.fun(e)}),new Promise(function(t){var r=l.now();s.processPGN(e,n,o,i.rate).then(function(){var e=l.now(),n=Math.round(e-r)/1e3,i=Math.round(s.cntMoves/n);console.log("".concat(s.cntGames," games (").concat(s.cntMoves," moves) processed in ").concat(n,"s (").concat(i," moves/s)")),t()})})}},{key:"saveData",value:function(e,t){f.writeFile(e,JSON.stringify(t),function(e){e?console.error(e):console.log("File has been created.")})}},{key:"loadData",value:function(e){var t=JSON.parse(f.readFileSync(e,"utf8"));return console.log("File '".concat(e,"' has been loaded.")),t}},{key:"generateHeatmap",value:function(t,n,i,o){var s,a;"string"==typeof n?(s=r.default.algebraicToCoords(n),a=n):(s=n,a=r.default.coordsToAlgebraic(n));for(var u={alg:a,coords:s,piece:e.getStartingPiece(s)},c=[],l=0,f=1e6,h=0;h<8;h+=1){for(var p=new Array(8),v=0;v<8;v+=1){var d=[h,v],b={alg:r.default.coordsToAlgebraic(d),coords:d,piece:e.getStartingPiece(d)};p[v]=i(t,u,b,o),p[v]>l&&(l=p[v]),p[v]<f&&(f=p[v])}c.push(p)}return[c,f,l]}},{key:"generateComparisonHeatmap",value:function(t,n,r,i,o){for(var s=[],a=0,u=1e5,c=e.generateHeatmap(t,r,i,o),l=e.generateHeatmap(n,r,i,o),f=0;f<8;f+=1){for(var h=new Array(8),p=0;p<8;p+=1){var v=c[0][f][p],d=l[0][f][p];h[p]=0===v||0===d?0:100*(v>=d?v/d-1:-d/v+1),h[p]>a&&(a=h[p]),h[p]<u&&(u=h[p])}s.push(h)}return[s,u,a]}},{key:"generateList",value:function(e){for(var t=[],n=0;n<8;n+=1)for(var r=0;r<8;r+=1){var i=e[n][r];i=i.toFixed(2),Math.abs(i)>.001&&(0===n?t.push(["b".concat(p[r]),i]):1===n?t.push(["b".concat(h[r]),i]):6===n?t.push(["w".concat(h[r]),i]):7===n&&t.push(["w".concat(p[r]),i]))}return t.sort(function(e,t){return t[1]-e[1]}),t}},{key:"getStartingPiece",value:function(e){var t="",n="";return 0===e[0]?(t="b",n=p[e[1]]):1===e[0]?(t="b",n=h[e[1]]):6===e[0]?(t="w",n=h[e[1]]):7===e[0]&&(t="w",n=p[e[1]]),{color:t,name:n}}}],(n=null)&&c(t.prototype,n),i&&c(t,i),e}();v.Tracker={Game:s.default,Piece:i.default,Tile:o.default,Base:a.default};var d=v;t.default=d,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(5))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=n(6),f=n(7),h="abcdefgh",p=function e(){c(this,e),this.san="",this.player="",this.piece="",this.castles="",this.takes={},this.promotesTo="",this.from=[-1,-1],this.to=[-1,-1]},v=function(e){function t(){var e;return c(this,t),(e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).board=new i.default,e.currentMove=new p,e.activePlayer=0,e.cntMoves=0,e.cntGames=0,e.gameAnalyzers=[],e.moveAnalyzers=[],e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,f),n=t,o=[{key:"checkConfig",value:function(e){var t={};return t.hasFilter=Object.prototype.hasOwnProperty.call(e,"filter"),t.filter=t.hasFilter?e.filter:function(){return!0},t.cntGames=Object.prototype.hasOwnProperty.call(e,"cntGames")?e.cntGames:1/0,t.split=!!Object.prototype.hasOwnProperty.call(e,"split")&&e.split,t}},{key:"algebraicToCoords",value:function(e){var t=[],n=e.split("");return t.push(8-n[1]),t.push(h.indexOf(n[0])),t}},{key:"coordsToAlgebraic",value:function(e){var t=h[e[1]];return t+=8-e[0]}},{key:"preProcess",value:function(e){return e.replace(/#|\+|\?|!/g,"")}}],(r=[{key:"processPGN",value:function(e,n,r,i){var o=this,s=t.checkConfig(n);r.forEach(function(e){"move"===e.type?o.moveAnalyzers.push(e):"game"===e.type&&o.gameAnalyzers.push(e)});var a=this.gameAnalyzers.length;return new Promise(function(t,n){var r=new l(e,{skipEmptyLines:!0}),u={};r.on("error",function(e){console.log(e),n()}),r.on("line",function(e){r.pause(),function(e){if(e.startsWith("[")&&(s.hasFilter||a>0)){var t=e.match(/\[(.*?)\s/)[1],n=e.match(/"(.*?)"/)[1];u[t]=n}else e.startsWith("1")&&(u.moves=e.replace(/\{(.*?)\}\s/g,"").replace(/\d+\.+\s/g,"").replace(" *","").split(" "),!s.filter(u)&&s.hasFilter||o.processGame(u),o.cntGames%i==0&&o.emit("status",o.cntGames),u={});o.cntGames>=s.cntGames?(r.close(),r.end()):r.resume()}(e)}),r.on("end",function(){console.log("Read entire file."),t()})})}},{key:"processGame",value:function(e){for(var t=this,n=e.moves,r=0;r<n.length;r+=1)this.activePlayer=r%2,this.parseMove(n[r]),this.moveAnalyzers.forEach(function(e){e.track(t.currentMove)}),this.board.move(this.currentMove);this.cntMoves+=n.length-1,this.cntGames+=1,this.board.reset(),this.gameAnalyzers.forEach(function(t){t.track(e)})}},{key:"reset",value:function(){this.board.reset(),this.activePlayer=0}},{key:"parseMove",value:function(e){var n=e.substring(0,1),r=t.preProcess(e);this.currentMove=new p,this.currentMove.san=e,this.currentMove.player=0===this.activePlayer?"w":"b",null===n.match(/\d/)&&(n.toLowerCase()===n?this.pawnMove(r):"O"!==n?this.pieceMove(r):this.currentMove.castles=r)}},{key:"pawnMove",value:function(e){var t=this.activePlayer%2*-2+1,n=[],r=[],i=e,o=0;if(i.includes("x"))i=i.replace("x",""),r[0]=8-parseInt(i.substring(2,3),10),r[1]=h.indexOf(i.substring(1,2)),n[0]=r[0]+t,n[1]=h.indexOf(i.substring(0,1)),null===this.board.tiles[r[0]][r[1]]&&(o="w"===this.currentMove.player?1:-1),this.currentMove.takes.piece=this.board.tiles[r[0]+o][r[1]].name,this.currentMove.takes.pos=[r[0]+o,r[1]];else{var s=8-parseInt(i.substring(1,2),10),a=h.indexOf(i.substring(0,1));n[1]=a,r[0]=s,r[1]=a;for(var u=s+t;u<8&&u>=0;u+=t)if(null!==this.board.tiles[u][a]&&this.board.tiles[u][a].name.includes("P")){n[0]=u;break}}this.currentMove.to=r,this.currentMove.from=n,this.currentMove.piece=this.board.tiles[n[0]][n[1]].name,i.includes("=")&&(this.currentMove.promotesTo=i.substring(i.length-1,i.length))}},{key:"pieceMove",value:function(e){var t=e,n=!1,r={from:[],to:[]},i=t.substring(0,1);if((t=t.substring(1,t.length)).includes("x")&&(n=!0,t=t.replace("x","")),4===t.length)r.from[0]=8-parseInt(t.substring(1,2),10),r.from[1]=h.indexOf(t.substring(0,1)),r.to[0]=8-parseInt(t.substring(3,4),10),r.to[1]=h.indexOf(t.substring(2,3));else if(3===t.length){var o=8-parseInt(t.substring(2,3),10),s=h.indexOf(t.substring(1,2)),a=-1,u=-1;h.indexOf(t.substring(0,1))>=0?u=h.indexOf(t.substring(0,1)):a=8-parseInt(t.substring(0,1),10),r=this.findPiece(o,s,a,u,i)}else{var c=8-parseInt(t.substring(1,2),10),l=h.indexOf(t.substring(0,1));r=this.findPiece(c,l,-1,-1,i)}this.currentMove.from=r.from,this.currentMove.to=r.to,this.currentMove.piece=this.board.tiles[r.from[0]][r.from[1]].name,n&&(this.currentMove.takes.piece=this.board.tiles[this.currentMove.to[0]][this.currentMove.to[1]].name,this.currentMove.takes.pos=this.currentMove.to)}},{key:"findPiece",value:function(e,t,n,r,i){var o;return"R"===i?o=this.findLine(e,t,n,r,i):"B"===i?o=this.findDiag(e,t,n,r,i):"Q"===i||"K"===i?-1===(o=this.findDiag(e,t,n,r,i)).from[0]&&(o=this.findLine(e,t,n,r,i)):"N"===i&&(o=this.findKnight(e,t,n,r,i)),-1===o.from[0]&&(console.log("Error: no piece for move ".concat(i," to (").concat(e,",").concat(t,") found!")),console.log(this.cntGames),console.log(this.currentMove),this.board.printPosition()),o}},{key:"findDiag",value:function(e,t,n,r,i){var o=this.currentMove.player,s=[],a=[];s[0]=-1,s[1]=-1,a[0]=e,a[1]=t;for(var u=-1;u<=1;u+=2)for(var c=!1,l=!1,f=1;f<8;f+=1){var h=a[0]+u*f,p=a[1]+f,v=a[0]-u*f,d=a[1]-f;if(!c&&h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var b=this.board.tiles[h][p];if(!b.name.includes(i)||b.color!==o||-1!==n&&h!==n||-1!==r&&p!==r)c=!0;else if(!this.checkCheck([h,p],[a[0],a[1]]))return s[0]=h,s[1]=p,{from:s,to:a}}if(!l&&v>=0&&v<8&&d>=0&&d<8&&null!==this.board.tiles[v][d]){var y=this.board.tiles[v][d];if(!y.name.includes(i)||y.color!==o||-1!==n&&v!==n||-1!==r&&d!==r)l=!0;else if(!this.checkCheck([v,d],[a[0],a[1]]))return s[0]=v,s[1]=d,{from:s,to:a}}}return{from:s,to:a}}},{key:"findLine",value:function(e,t,n,r,i){var o=this.currentMove.player,s=[],a=[];s[0]=-1,s[1]=-1,a[0]=e,a[1]=t;for(var u=-1;u<=1;u+=2)for(var c=!1,l=!1,f=1;f<8;f+=1){var h=a[0],p=a[1]-u*f,v=a[0]-u*f,d=a[1];if(!c&&h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var b=this.board.tiles[h][p];if(!b.name.includes(i)||b.color!==o||-1!==n&&h!==n||-1!==r&&p!==r)c=!0;else if(!this.checkCheck([h,p],[a[0],a[1]]))return s[0]=h,s[1]=p,{from:s,to:a}}if(!l&&v>=0&&v<8&&d>=0&&d<8&&null!==this.board.tiles[v][d]){var y=this.board.tiles[v][d];if(!y.name.includes(i)||y.color!==o||-1!==n&&v!==n||-1!==r&&d!==r)l=!0;else if(!this.checkCheck([v,d],[a[0],a[1]]))return s[0]=v,s[1]=d,{from:s,to:a}}}return{from:s,to:a}}},{key:"findKnight",value:function(e,t,n,r,i){var o=this.currentMove.player,s=[],a=[];s[0]=-1,s[1]=-1,a[0]=e,a[1]=t;for(var u=-2;u<=2;u+=4)for(var c=-1;c<=1;c+=2){var l=a[0]+u,f=a[1]+c,h=a[0]+c,p=a[1]+u;if(l>=0&&l<8&&f>=0&&f<8&&null!==this.board.tiles[l][f]){var v=this.board.tiles[l][f];if(v.name.includes(i)&&v.color===o&&(-1===n||l===n)&&(-1===r||f===r)&&!this.checkCheck([l,f],[a[0],a[1]]))return s[0]=l,s[1]=f,{from:s,to:a}}if(h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var d=this.board.tiles[h][p];if(d.name.includes(i)&&d.color===o&&(-1===n||h===n)&&(-1===r||p===r)&&!this.checkCheck([h,p],[a[0],a[1]]))return s[0]=h,s[1]=p,{from:s,to:a}}}return{from:s,to:a}}},{key:"checkCheck",value:function(e,t){var n=this.currentMove.player,r="w"===this.currentMove.player?"b":"w",i=this.board.kingPos[n],o=!1;if(i[0]===e[0]&&i[1]===e[1])return!1;var s=[];s[0]=e[0]-i[0],s[1]=e[1]-i[1];var a=[];if(0===s[0]||0===s[1])a[0]="Q",a[1]="R";else{if(Math.abs(s[0])!==Math.abs(s[1]))return!1;a[0]="Q",a[1]="B"}0!==s[0]&&(s[0]/=Math.abs(s[0])),0!==s[1]&&(s[1]/=Math.abs(s[1]));var u=this.board.tiles[e[0]][e[1]],c=this.board.tiles[t[0]][t[1]];this.board.tiles[e[0]][e[1]]=null,this.board.tiles[t[0]][t[1]]=u;for(var l=!1,f=1;f<8&&!o&&!l;f+=1){var h=i[0]+f*s[0],p=i[1]+f*s[1];if(h>=0&&h<8&&p>=0&&p<8&&null!==this.board.tiles[h][p]){var v=this.board.tiles[h][p];(v.name.includes(a[0])||v.name.includes(a[1]))&&v.color===r?o=!0:l=!0}}return this.board.tiles[e[0]][e[1]]=u,this.board.tiles[t[0]][t[1]]=c,o}}])&&s(n.prototype,r),o&&s(n,o),t}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],s=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],a=function e(t,n){i(this,e),this.name=t,this.color=n},u=function(){function e(){i(this,e),this.tiles=new Array(8);for(var t=0;t<8;t+=1){for(var n=new Array(8),r=0;r<8;r+=1){n[r]=null;var u=0===t||1===t?"b":"w";0===t||7===t?n[r]=new a(s[r],u):1!==t&&6!==t||(n[r]=new a(o[r],u))}this.tiles[t]=n}this.defaultTiles=this.tiles.map(function(e){return e.slice()}),this.kingPos={w:[7,4],b:[0,4]}}var t,n,u;return t=e,(n=[{key:"move",value:function(e){var t=e.from,n=e.to;""!==e.castles?this.castle(e.castles,e.player):-1!==t[0]&&("pos"in e.takes&&(this.tiles[e.takes.pos[0]][e.takes.pos[1]]=null),this.tiles[n[0]][n[1]]=this.tiles[t[0]][t[1]],this.tiles[t[0]][t[1]]=null,""!==e.promotesTo&&(this.tiles[n[0]][n[1]]=new a(e.promotesTo,e.player)),"K"===e.san.substring(0,1)&&(this.kingPos[e.player]=n))}},{key:"castle",value:function(e,t){var n="w"===t?7:0,r=6,i=7,o=5;"O-O-O"===e&&(r=2,o=3,i=0),this.tiles[n][r]=this.tiles[n][4],this.tiles[n][o]=this.tiles[n][i],this.tiles[n][4]=null,this.tiles[n][i]=null,this.kingPos[t]=[n,r]}},{key:"reset",value:function(){this.tiles=this.defaultTiles.map(function(e){return e.slice()}),this.kingPos={w:[7,4],b:[0,4]}}},{key:"printPosition",value:function(){for(var e=0;e<8;e+=1){for(var t=[],n=0;n<8;n+=1){var r=this.tiles[e][n];null!==r?t.push(r.color+r.name):t.push("...")}console.log(t)}}}])&&r(t.prototype,n),u&&r(t,u),e}();t.default=u,e.exports=t.default},function(e,t){e.exports=require("line-by-line")},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(0))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],l=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"move"))).b={},e.w={},c.forEach(function(t){e.w[t]={},e.b[t]={}}),l.forEach(function(t){e.w[t]={},e.b[t]={}}),Object.keys(e.w).forEach(function(t){c.forEach(function(n){e.w[t][n]=0,e.b[t][n]=0}),l.forEach(function(n){e.w[t][n]=0,e.b[t][n]=0})}),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,i.default),n=t,(r=[{key:"track",value:function(e){this.startTimer();var t=e.player,n=e.piece,r=e.takes;void 0!==r.piece&&n.length>1&&r.piece.length>1&&this.processTakes(t,n,r.piece),this.endTimer()}},{key:"processTakes",value:function(e,t,n){this[e][t][n]+=1}}])&&s(n.prototype,r),o&&s(n,o),t}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(0))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=["Pa","Pb","Pc","Pd","Pe","Pf","Pg","Ph"],f=["Ra","Nb","Bc","Qd","Ke","Bf","Ng","Rh"],h=function e(){c(this,e),this.movedTo=0,this.wasOn=0,this.killedOn=0,this.wasKilledOn=0},p=function e(t,n){c(this,e),this.piece=t,this.color=n,this.lastMovedOn=0},v=function(e){function t(){var e;c(this,t),(e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"move"))).cntMovesGame=0,e.cntMovesTotal=0,e.tiles=new Array(8);for(var n=function(t){for(var n=new Array(8),r=function(e){n[e]={b:{},w:{}},n[e].b=new h,n[e].w=new h,l.forEach(function(t){n[e].b[t]=new h,n[e].w[t]=new h}),f.forEach(function(t){n[e].b[t]=new h,n[e].w[t]=new h})},i=0;i<8;i+=1)r(i);e.tiles[t]=n},r=0;r<8;r+=1)n(r);for(r=0;r<8;r+=1)for(var i=0;i<8;i+=1)e.resetCurrentPiece(r,i);return e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,i.default),n=t,(r=[{key:"resetCurrentPiece",value:function(e,t){var n,r,i=!1;0===e?(n="b",r=f[t],i=!0):1===e?(n="b",r=l[t],i=!0):6===e?(n="w",r=l[t],i=!0):7===e&&(n="w",r=f[t],i=!0),this.tiles[e][t].currentPiece=i?new p(r,n):null}},{key:"track",value:function(e){this.startTimer();var t=e.to,n=e.from,r=e.player,i=e.piece,o=e.takes,s=e.castles;if(-1!==t[0])this.cntMovesGame+=1,void 0!==o.piece&&this.processTakes(o.pos,r,i,o.piece),this.processMove(n,t,r,i);else if(""!==s){this.cntMovesGame+=1;var a="w"===r?7:0,u="Rh",c=6,l=5,f=7;"O-O-O"===s&&(c=2,l=3,f=0,u="Ra"),this.processMove([a,4],[a,c],r,"Ke"),this.processMove([a,f],[a,l],r,u)}else{for(var h=0;h<8;h+=1)for(var p=0;p<8;p+=1){null!==this.tiles[h][p].currentPiece&&this.addOccupation([h,p]),this.resetCurrentPiece(h,p)}this.cntMovesTotal+=this.cntMovesGame,this.cntMovesGame=0}this.endTimer()}},{key:"processMove",value:function(e,t,n,r){r.length>1&&(this.addOccupation(e),this.tiles[t[0]][t[1]].currentPiece=this.tiles[e[0]][e[1]].currentPiece,this.tiles[t[0]][t[1]].currentPiece.lastMovedOn=this.cntMovesGame,this.tiles[e[0]][e[1]].currentPiece=null,this.tiles[t[0]][t[1]][n].movedTo+=1,this.tiles[t[0]][t[1]][n][r].movedTo+=1)}},{key:"processTakes",value:function(e,t,n,r){if(r.length>1){var i="w"===t?"b":"w";this.tiles[e[0]][e[1]][i].wasKilledOn+=1,this.tiles[e[0]][e[1]][i][r].wasKilledOn+=1,this.addOccupation(e),this.tiles[e[0]][e[1]].currentPiece=null}n.length>1&&(this.tiles[e[0]][e[1]][t].killedOn+=1,this.tiles[e[0]][e[1]][t][n].killedOn+=1)}},{key:"addOccupation",value:function(e){var t=this.tiles[e[0]][e[1]].currentPiece,n=this.cntMovesGame-t.lastMovedOn;this.tiles[e[0]][e[1]][t.color].wasOn+=n,this.tiles[e[0]][e[1]][t.color][t.piece].wasOn+=n}}])&&s(n.prototype,r),o&&s(n,o),t}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(0))&&r.__esModule?r:{default:r};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"game"))).wins=[0,0,0],e.cntGames=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,i.default),n=t,(r=[{key:"track",value:function(e){switch(this.startTimer(),this.cntGames+=1,e.Result){case"1-0":this.wins[0]+=1;break;case"1/2-1/2":this.wins[1]+=1;break;case"0-1":this.wins[2]+=1}this.endTimer()}}])&&s(n.prototype,r),o&&s(n,o),t}();t.default=c,e.exports=t.default},function(e,t){e.exports=require("fs")}])});
//# sourceMappingURL=chessalyzer.min.js.map